#create jetstream instance

#check if R is installed
R --version
#if R is not installed
sudo apt update
sudo apt -y install r-base

#check if perl is installed
perl --version

#clone repo
git clone https://github.com/incertae-sedis/cavatica.git

#example fetching PubMed and PMC papers containing the word "Neo4j" and "Cytoscape".
cd cavatica/data
mkdir test
cd test
echo "Neo4j" > config.txt
echo "Cytoscape" >> config.txt
../../code/script.sh
#####
#error message:
#Installing packages into ‘/usr/local/lib/R/site-library’
#(as ‘lib’ is unspecified)
#Warning in install.packages(new.pkg, dependencies = TRUE, repos = "http://cran.us.r-project.org") :
#  'lib = "/usr/local/lib/R/site-library"' is not writable
#Error in install.packages(new.pkg, dependencies = TRUE, repos = "http://cran.us.r-project.org") : 
#  unable to install packages
#Calls: check.packages -> install.packages
#Execution halted


#In order to access R to install packages first run:
sudo apt-get install libcurl4-openssl-dev 
# the command is R, after you're done with R, you need to use this command quit(save = "default", status = 0, runLast = TRUE)
#to download packages like ggplot2 and readr just go to the main directory (cd ..) , command R, in the R environment  
R
install.packages(c("Rcpp", "readr"))
install.packages("ggplot2")

#clone docker_implementation branch, and some of the code needed to be taken out
git clone -b docker_implementation https://github.com/TeamMango/cavatica.git
cd cavatica/data
mkdir test
cd test
echo "Neo4j" > config.txt
echo "Cytoscape" >> config.txt
../../code/script.sh

Just FYI if you want to install a package for yourself only you don't need to give R super-user privileges. use env var
#####
#https://askubuntu.com/questions/931375/r-and-rstudio-installation-and-package-error
export R_LIBS_USER=~/.local/lib/R/site-library
#check env variables, should see R_LIBS_USER
env
#append export file to profile to assure that this environment variable 
#is set before starting R or it won't find the packages installed to that location
export R_LIBS_USER=~/.local/lib/R/site-library >> ~/.profile
#now install packages
R CMD INSTALL

#error caused by resetting the library path
Loading required package: ggplot2
Loading required package: readr
ggplot2   readr
   TRUE   FALSE
There were 21 warnings (use warnings() to see them)
Error in library(readr) : there is no package called 'readr'
Execution halted
The command '/bin/sh -c ../../code/script.sh' returned a non-zero code: 1
